 --- BIN FILE READ: NICA_Gold
  10999 INCLUDE 'NICA_Gold';
  11000   PROCEDURE MCMCALC ALPHA0 ALPHA1;
  11001     VARIABLE TMPALPHA 100;
  11002     VARIABLE I 1;
  11003     VARIABLE MCM0 1;
  11004     VARIABLE MCM1 1;
  11005     VARIABLE MCM2 1;
  11006     VARIABLE MCM3 1;
  11007     VARIABLE MCM4 1;
  11008     MCM MAP SPOS TMPALPHA; %MCM: 3587
  11009     MCM0 := -TMPALPHA|(0&0&0&0&0&0);
  11010     MCM1 := -TMPALPHA|(0&0&0&0&0&1);
  11011     MCM2 := -2*TMPALPHA|(0&0&0&0&0&2);
  11012     MCM3 := -2*3*TMPALPHA|(0&0&0&0&0&3);
  11013     MCM4 := -2*3*4*TMPALPHA|(0&0&0&0&0&4);
  11014     ALPHA0:= MCM1;
  11015     ALPHA1:= MCM2;
  11016     WRITE 6 '++++++++ MOMENTUM COMPACTION FACTOR ++++++++';
  11017     WRITE 6 'MC0 = '&ST(MCM0);
  11018     WRITE 6 'MC1 = '&ST(MCM1);
  11019     WRITE 6 'MC2 = '&ST(MCM2);
  11020     WRITE 6 'MC3 = '&ST(MCM3);
  11021     WRITE 6 'MC4 = '&ST(MCM4);
  11022     WRITE 6 '++++++++++++++++++++++++++++++++++++++++++++';
  11023     ENDPROCEDURE;
  11024   PROCEDURE INJECT NUM PSI_DEG;
  11025     VARIABLE X 100;
  11026     VARIABLE I 1;
  11027     VARIABLE PSI 1;
  11028     VARIABLE SY 1;
  11029     VARIABLE SZ 1;
  11030     PSI := DEG2RAD(PSI_DEG); %DEG2RAD: 9856
  11031     X := LINSPACE(10E-3, 10E-3, NUM*3); %LINSPACE: 9840
  11032     SY := SIN(PSI);
  11033     SZ := COS(PSI);
  11034     CR; %CR:  947
  11035     SR 0 0 0 0 0 0 0 0 1; %SR: 2082
  11036     SSR 0 SY SZ; %SSR: 2197
  11037     LOOP I 1 NUM;
  11038       SR X|I 0 0 0 0 0 0 0 1; %SR: 2082
  11039       SSR 0 SY SZ; %SSR: 2197
  11040       SR 0 0 X|I 0 0 0 0 0 1; %SR: 2082
  11041       SSR 0 SY SZ; %SSR: 2197
  11042       SR 0 0 0 0 0 (X|I)/10 0 0 1; %SR: 2082
  11043       SSR 0 SY SZ; %SSR: 2197
  11044       ENDLOOP;
  11045     ENDPROCEDURE;
  11046   PROCEDURE MAIN;
  11047     VARIABLE WHERE 500;
  11048     VARIABLE MRKR 200;
  11049     VARIABLE DGAMMA 1;
  11050     VARIABLE NFREE 1;
  11051     VARIABLE FTR 1;
  11052     VARIABLE CASE 1;
  11053     VARIABLE PCT 1;
  11054     VARIABLE I 1;
  11055     VARIABLE NTURN 1;
  11056     VARIABLE U 1;
  11057     VARIABLE M_P 1;
  11058     VARIABLE GAMMA 1;
  11059     VARIABLE BETA 1;
  11060     VARIABLE NTOT 1;
  11061     VARIABLE DQ_MAX 1;
  11062     VARIABLE DQ_MIN 1;
  11063     VARIABLE DELTAQ 1;
  11064     VARIABLE SCALE 1;
  11065     VARIABLE NSWITCH 1;
  11066     VARIABLE ALPHA0 1;
  11067     VARIABLE ALPHA1 1;
  11068     VARIABLE ETA0 1;
  11069     VARIABLE ETA1 1;
  11070     VARIABLE SGX 1;
  11071     VARIABLE SGY 1;
  11072     VARIABLE PNUM 1;
  11073     VARIABLE PSI0_DEG 1;
  11074     VARIABLE RAYH 10000 8;
  11075     VARIABLE SPIH 10000 3;
  11076     VARIABLE MUARR 100 4;
  11077     U := 300;
  11078     M_P := 0.938E9;
  11079     DGAMMA := (U/M_P);
  11080     GAMMA := 4.042;
  11081     BETA := SQRT(1-1/(GAMMA*GAMMA));
  11082     NTOT := 200000;
  11083     SGX := 0.3599718607904814E-001;
  11084     SGY := -.8627374333752474E-001;
  11085     DELTAQ := 0.0;
  11086     SET_FOR_PROTONS GAMMA; %SET_FOR_PROTONS:10543
  11087     LATTICE SGX SGY 1 DELTAQ; %LATTICE:10663
  11088     WRITE 6 '++++++++++ Magnetic Rigidity';
  11089     WRITE 6 CONS(CHIM);
  11090     WRITE 6 'END of LATTICE';
  11091     PM 6; %PM: 1574
  11092     MCMCALC ALPHA0 ALPHA1; %MCMCALC:11000
  11093     WRITE 6 'ALPHA0 = '&ST(ALPHA0);
  11094     WRITE 6 'ALPHA1 = '&ST(ALPHA1);
  11095     ETA0 := ALPHA0 - 1/(GAMMA*GAMMA);
  11096     ETA1 := ALPHA1+(3/2)*(BETA*BETA)/(GAMMA*GAMMA)-ALPHA0/(GAMMA*GAMMA
                  )+1/(GAMMA*GAMMA*GAMMA*GAMMA);
  11097     WRITE 6 'ETA0 = '&ST(ETA0);
  11098     WRITE 6 'ETA1 = '&ST(ETA1);
  11099     PNUM := 10;
  11100     PSI0_DEG := 45;
  11101     MRKR := 'B4_RF';
  11102     OPENF 772 'dat/TR/'&MRKR&'/LATTICE.dat' 'REPLACE';
  11103     WRITE 772 'GAMMA ALPHA0 ALPHA1 ETA0 ETA1';
  11104     WRITE 772 ST(GAMMA)&' '&ST(ALPHA0)&' '&ST(ALPHA1)&' '&ST(ETA0)&' '
                  &ST(ETA1);
  11105     CLOSEF 772;
  11106     INJECT PNUM PSI0_DEG; %INJECT:11024
  11107     WRITE 6 '^^^^ INITIAL SPIN PSI'&SF(PSI0_DEG,'(F15.7)'); %SF:  285
  11108     WRITE 6 '******************** STARTING TRACKING';
  11109     OPENF 99 'dat/TR/'&MRKR&'/PRAY_'&MRKR&'.dat' 'REPLACE';
  11110     PRAY 99; %PRAY: 2299
  11111     CLOSEF 99;
  11112     OPENF 772 'dat/TR/'&MRKR&'/TRPRAY_'&MRKR&'.dat' 'REPLACE';
  11113     OPENF 893 'dat/TR/'&MRKR&'/TRPSPI_'&MRKR&'.dat' 'REPLACE';
  11114     TRPRAY 772; %TRPRAY: 5327
  11115     TRPSPI 893; %TRPSPI: 5337
  11116     TR NTOT (NTOT/100) -1 -3 1.2 1.2 0 0 -12; %TR: 4756
  11117     CLOSEF 772;
  11118     CLOSEF 893;
  11119     WRITE 6 'TRACKING END';
  11120     ENDPROCEDURE;
  11121   PROCEDURE RUN;
  11122     OV 3 3 0; %OV:  969
  11123     DAEPS 1E-12;
  11124     MAIN; %MAIN:11046
  11125     ENDPROCEDURE;
  11126   RUN; %RUN:11121
