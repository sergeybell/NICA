 --- BIN FILE READ: NICA_Gold_maps
  11538 INCLUDE 'NICA_Gold_maps';
  11539   PROCEDURE PICK INDEX MAPARR SPNRARR;
  11540     VARIABLE I 1;
  11541     VARIABLE J 1;
  11542     LOOP I 1 TWOND;
  11543       MSC(I) := MAPARR(I, INDEX);
  11544       ENDLOOP;
  11545     LOOP I 1 3;
  11546       LOOP J 1 3;
  11547         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  11548         ENDLOOP;
  11549       ENDLOOP;
  11550     ENDPROCEDURE;
  11551   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  11552     VARIABLE J 1;
  11553     WRITE 6 '* '&ST(START);
  11554     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  11555     LOOP J (START+1) TO;
  11556       WRITE 6 '**       '&ST(J);
  11557       PICK J MAPARR SPNRARR; %PICK:11539
  11558       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  11559       UPDATE 1 1; %UPDATE: 1261
  11560       ENDLOOP;
  11561     LOOP J FROM (START-1);
  11562       WRITE 6 '**       '&ST(J);
  11563       PICK J MAPARR SPNRARR; %PICK:11539
  11564       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  11565       UPDATE 1 1; %UPDATE: 1261
  11566       ENDLOOP;
  11567     ENDPROCEDURE;
  11568   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  11569     VARIABLE NUM1 1;
  11570     VARIABLE NUM2 1;
  11571     VARIABLE OBJ 1;
  11572     IF COORD='X';
  11573       NUM1:=1;
  11574       NUM2:=2;
  11575       AL0:=0;
  11576       BET0:=20.0;
  11577       GAM0:=1.0/BET0;
  11578       ELSEIF COORD='Y';
  11579       NUM1:=3;
  11580       NUM2:=4;
  11581       AL0:=0;
  11582       BET0:=3;
  11583       GAM0:=1.0/BET0;
  11584       ELSEIF LO(1);
  11585       WRITE 6 'UNKNOWN COORDINATE';
  11586       ENDIF;
  11587     FIT AL0 BET0 GAM0;
  11588       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  11589       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  11590       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  11591       ENDFIT 1E-20 5000 1 OBJ;
  11592     ENDPROCEDURE;
  11593   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  11594     VARIABLE J 1;
  11595     VARIABLE NUM1 1;
  11596     VARIABLE NUM2 1;
  11597     IF COORD='X';
  11598       NUM1:=1;
  11599       NUM2:=2;
  11600       ELSEIF COORD='Y';
  11601       NUM1:=3;
  11602       NUM2:=4;
  11603       ELSEIF LO(1);
  11604       WRITE 6 'UNKNOWN COORDINATE';
  11605       ENDIF;
  11606     UM; %UM: 1488
  11607     BETS(1):=BET0;
  11608     OPENF 800 TAG 'REPLACE';
  11609     WRITE 800 ST(BETS(1))&'     '&ST(0);
  11610     LOOP J 1 NUM_ELE;
  11611       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:11551
  11612       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  11613       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  11614       UM; %UM: 1488
  11615       ENDLOOP;
  11616     CLOSEF 800;
  11617     ENDPROCEDURE;
  11618   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  11619     VARIABLE NUM1 1;
  11620     VARIABLE NUM2 1;
  11621     VARIABLE OBJ 1;
  11622     IF COORD='X';
  11623       NUM1:=1;
  11624       NUM2:=2;
  11625       D0:=0;
  11626       DPR0:=0;
  11627       ELSEIF COORD='Y';
  11628       NUM1:=3;
  11629       NUM2:=4;
  11630       D0:=0;
  11631       DPR0:=0;
  11632       ELSEIF LO(1);
  11633       WRITE 6 'UNKNOWN COORDINATE';
  11634       ENDIF;
  11635     FIT D0 DPR0;
  11636       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  11637       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  11638       ENDFIT 1E-20 5000 1 OBJ;
  11639     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  11640     WRITE 6 D0 DPR0;
  11641     ENDPROCEDURE;
  11642   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  11643     VARIABLE J 1;
  11644     VARIABLE NUM1 1;
  11645     VARIABLE NUM2 1;
  11646     IF COORD='X';
  11647       NUM1:=1;
  11648       NUM2:=2;
  11649       ELSEIF COORD='Y';
  11650       NUM1:=3;
  11651       NUM2:=4;
  11652       ELSEIF LO(1);
  11653       WRITE 6 'UNKNOWN COORDINATE';
  11654       ENDIF;
  11655     UM; %UM: 1488
  11656     DS(1):=D0;
  11657     OPENF 800 TAG 'REPLACE';
  11658     WRITE 800 ST(DS(1))&'     '&ST(0);
  11659     LOOP J 1 NUM_ELE;
  11660       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:11551
  11661       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  11662       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  11663       UM; %UM: 1488
  11664       ENDLOOP;
  11665     CLOSEF 800;
  11666     ENDPROCEDURE;
  11667   PROCEDURE MAIN;
  11668     VARIABLE GAMMA 1;
  11669     VARIABLE SGX1 1;
  11670     VARIABLE SGX2 1;
  11671     VARIABLE SGY1 1;
  11672     VARIABLE SGY2 1;
  11673     VARIABLE EB1 1;
  11674     VARIABLE ALPHAX0 1;
  11675     VARIABLE BETAX0 1;
  11676     VARIABLE GAMMAX0 1;
  11677     VARIABLE BETAXS 1 313;
  11678     VARIABLE ALPHAY0 1;
  11679     VARIABLE BETAY0 1;
  11680     VARIABLE GAMMAY0 1;
  11681     VARIABLE BETAYS 1 313;
  11682     VARIABLE DISPX0 1;
  11683     VARIABLE DISPXPR0 1;
  11684     VARIABLE DISPXS 1 313;
  11685     VARIABLE DISPY0 1;
  11686     VARIABLE DISPYPR0 1;
  11687     VARIABLE DISPYS 1 313;
  11688     VARIABLE MAPARR1 1000 6 313;
  11689     VARIABLE SPNRARR1 1000 3 3 313;
  11690     VARIABLE NUM_ELE 1;
  11691     GAMMA := 1.28985692;
  11692     NUM_ELE := 272;
  11693     OV 3 3 0; %OV:  969
  11694     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10561
  11695     EB1 := 0.0;
  11696     SGX1 :=  0.0;
  11697     SGY1  := 0.0;
  11698     SGX2 :=  0.0;
  11699     SGY2  := 0.0;
  11700     ALPHAX0:=-0.764426;
  11701     BETAX0:=8.54379;
  11702     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  11703     ALPHAY0:=1.50582;
  11704     BETAY0:=14.6165;
  11705     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  11706     DISPX0:=0.000111426;
  11707     DISPXPR0:=0.0;
  11708     DISPY0:=0.0;
  11709     DISPYPR0:=0.0;
  11710     LATTICE SGX1 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10663
  11711     PM 6; %PM: 1574
  11712     WRITE 6 '++++++++++ Magnetic Rigidity';
  11713     WRITE 6 CONS(CHIM);
  11714     WRITE 6 ME(3,6); %ME:  516
  11715     BETS 'BETAX' 'X' NUM_ELE ALPHAX0 BETAX0 GAMMAX0 BETAXS MAPARR1 SPN
                  RARR1; %BETS:11593
  11716     ENDPROCEDURE;
  11717   PROCEDURE RUN;
  11718     MAIN; %MAIN:11667
  11719     ENDPROCEDURE;
  11720   RUN; %RUN:11717
